{"ast":null,"code":"import * as React from 'react';\nimport { useThree } from '@react-three/fiber';\n\nfunction CycleRaycast(_ref) {\n  let {\n    onChanged,\n    portal,\n    preventDefault = true,\n    scroll = true,\n    keyCode = 9\n  } = _ref;\n  const cycle = React.useRef(0);\n  const raycaster = useThree(state => state.raycaster);\n  const get = useThree(state => state.get);\n  const gl = useThree(state => state.gl);\n  React.useEffect(() => {\n    var _portal$current;\n\n    let hits = [];\n    let lastEvent = undefined;\n    const prev = raycaster.filter;\n    const target = (_portal$current = portal == null ? void 0 : portal.current) !== null && _portal$current !== void 0 ? _portal$current : gl.domElement.parentNode; // Render custom status\n\n    const renderStatus = () => target && onChanged && onChanged(hits, Math.round(cycle.current) % hits.length); // Overwrite the raycasters custom filter (this only exists in r3f)\n\n\n    raycaster.filter = (intersections, state) => {\n      // Reset cycle when the intersections change\n      let clone = [...intersections];\n\n      if (clone.length !== hits.length || !hits.every(hit => clone.map(e => e.object.uuid).includes(hit.object.uuid))) {\n        cycle.current = 0;\n        hits = clone;\n        renderStatus();\n      } // Run custom filter if there is one\n\n\n      if (prev) clone = prev(clone, state); // Cycle through the actual raycast intersects\n\n      for (let i = 0; i < Math.round(cycle.current) % clone.length; i++) {\n        const first = clone.shift();\n        clone = [...clone, first];\n      }\n\n      return clone;\n    }; // Cycle, refresh events and render status\n\n\n    const refresh = fn => {\n      var _get$events$handlers, _get$events$handlers2;\n\n      cycle.current = fn(cycle.current); // Cancel hovered elements and fake a pointer-move\n\n      (_get$events$handlers = get().events.handlers) == null ? void 0 : _get$events$handlers.onPointerCancel(undefined);\n      (_get$events$handlers2 = get().events.handlers) == null ? void 0 : _get$events$handlers2.onPointerMove(lastEvent);\n      renderStatus();\n    }; // Key events\n\n\n    const tabEvent = event => {\n      if (event.keyCode || event.which === keyCode) {\n        if (preventDefault) event.preventDefault();\n        if (hits.length > 1) refresh(current => current + 1);\n      }\n    }; // Wheel events\n\n\n    const wheelEvent = event => {\n      if (preventDefault) event.preventDefault();\n      let delta = 0;\n      if (!event) event = window.event;\n      if (event.wheelDelta) delta = event.wheelDelta / 120;else if (event.detail) delta = -event.detail / 3;\n      if (hits.length > 1) refresh(current => Math.abs(current - delta));\n    }; // Catch last move event and position custom status\n\n\n    const moveEvent = event => lastEvent = event;\n\n    document.addEventListener('pointermove', moveEvent, {\n      passive: true\n    });\n    if (scroll) document.addEventListener('wheel', wheelEvent);\n    if (keyCode !== undefined) document.addEventListener('keydown', tabEvent);\n    return () => {\n      // Clean up\n      raycaster.filter = prev;\n      if (keyCode !== undefined) document.removeEventListener('keydown', tabEvent);\n      if (scroll) document.removeEventListener('wheel', wheelEvent);\n      document.removeEventListener('pointermove', moveEvent);\n    };\n  }, [gl, get, raycaster, preventDefault, scroll, keyCode]);\n  return null;\n}\n\nexport { CycleRaycast };","map":{"version":3,"sources":["/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/@react-three/drei/web/CycleRaycast.js"],"names":["React","useThree","CycleRaycast","onChanged","portal","preventDefault","scroll","keyCode","cycle","useRef","raycaster","state","get","gl","useEffect","_portal$current","hits","lastEvent","undefined","prev","filter","target","current","domElement","parentNode","renderStatus","Math","round","length","intersections","clone","every","hit","map","e","object","uuid","includes","i","first","shift","refresh","fn","_get$events$handlers","_get$events$handlers2","events","handlers","onPointerCancel","onPointerMove","tabEvent","event","which","wheelEvent","delta","window","wheelDelta","detail","abs","moveEvent","document","addEventListener","passive","removeEventListener"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { useThree } from '@react-three/fiber';\n\nfunction CycleRaycast({\n  onChanged,\n  portal,\n  preventDefault = true,\n  scroll = true,\n  keyCode = 9\n}) {\n  const cycle = React.useRef(0);\n  const raycaster = useThree(state => state.raycaster);\n  const get = useThree(state => state.get);\n  const gl = useThree(state => state.gl);\n  React.useEffect(() => {\n    var _portal$current;\n\n    let hits = [];\n    let lastEvent = undefined;\n    const prev = raycaster.filter;\n    const target = (_portal$current = portal == null ? void 0 : portal.current) !== null && _portal$current !== void 0 ? _portal$current : gl.domElement.parentNode; // Render custom status\n\n    const renderStatus = () => target && onChanged && onChanged(hits, Math.round(cycle.current) % hits.length); // Overwrite the raycasters custom filter (this only exists in r3f)\n\n\n    raycaster.filter = (intersections, state) => {\n      // Reset cycle when the intersections change\n      let clone = [...intersections];\n\n      if (clone.length !== hits.length || !hits.every(hit => clone.map(e => e.object.uuid).includes(hit.object.uuid))) {\n        cycle.current = 0;\n        hits = clone;\n        renderStatus();\n      } // Run custom filter if there is one\n\n\n      if (prev) clone = prev(clone, state); // Cycle through the actual raycast intersects\n\n      for (let i = 0; i < Math.round(cycle.current) % clone.length; i++) {\n        const first = clone.shift();\n        clone = [...clone, first];\n      }\n\n      return clone;\n    }; // Cycle, refresh events and render status\n\n\n    const refresh = fn => {\n      var _get$events$handlers, _get$events$handlers2;\n\n      cycle.current = fn(cycle.current); // Cancel hovered elements and fake a pointer-move\n\n      (_get$events$handlers = get().events.handlers) == null ? void 0 : _get$events$handlers.onPointerCancel(undefined);\n      (_get$events$handlers2 = get().events.handlers) == null ? void 0 : _get$events$handlers2.onPointerMove(lastEvent);\n      renderStatus();\n    }; // Key events\n\n\n    const tabEvent = event => {\n      if (event.keyCode || event.which === keyCode) {\n        if (preventDefault) event.preventDefault();\n        if (hits.length > 1) refresh(current => current + 1);\n      }\n    }; // Wheel events\n\n\n    const wheelEvent = event => {\n      if (preventDefault) event.preventDefault();\n      let delta = 0;\n      if (!event) event = window.event;\n      if (event.wheelDelta) delta = event.wheelDelta / 120;else if (event.detail) delta = -event.detail / 3;\n      if (hits.length > 1) refresh(current => Math.abs(current - delta));\n    }; // Catch last move event and position custom status\n\n\n    const moveEvent = event => lastEvent = event;\n\n    document.addEventListener('pointermove', moveEvent, {\n      passive: true\n    });\n    if (scroll) document.addEventListener('wheel', wheelEvent);\n    if (keyCode !== undefined) document.addEventListener('keydown', tabEvent);\n    return () => {\n      // Clean up\n      raycaster.filter = prev;\n      if (keyCode !== undefined) document.removeEventListener('keydown', tabEvent);\n      if (scroll) document.removeEventListener('wheel', wheelEvent);\n      document.removeEventListener('pointermove', moveEvent);\n    };\n  }, [gl, get, raycaster, preventDefault, scroll, keyCode]);\n  return null;\n}\n\nexport { CycleRaycast };\n"]},"metadata":{},"sourceType":"module"}