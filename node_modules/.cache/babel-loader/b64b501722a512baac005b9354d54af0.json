{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { getSuccessfulTransactionCount, parseForBadgesForTypes, parseResponseForItems } from '../components/TokensList/BadgeHelper';\nimport { useEthers } from '@usedapp/core';\nexport function useBadgeList(signerAddress, overrideChainId, tags) {\n  _s();\n\n  const {\n    account,\n    chainId: providerChainId\n  } = useEthers();\n  const [badges, setBadges] = useState();\n  const chainId = overrideChainId || providerChainId;\n  useEffect(() => {\n    getTransactionsFor(signerAddress).then(async response => {\n      if (response) {\n        const items = parseResponseForItems(response);\n\n        if (items) {\n          const successCount = getSuccessfulTransactionCount(items);\n          const badges = parseForBadgesForTypes([successCount]);\n          console.log('badges : ', badges);\n          setBadges(badges);\n        }\n      } else {\n        const errorMessage = 'Couldnt fetch transaction data';\n        return Promise.reject(new Error(errorMessage));\n      }\n    }).catch(err => {\n      console.log(err);\n      setBadges(undefined);\n    });\n  }, [account]);\n  return badges;\n}\n\n_s(useBadgeList, \"T+5dwzrdNVeW0wP7rX4IoBz6/xU=\", false, function () {\n  return [useEthers];\n});\n\nexport const getTransactionsFor = async signerAddress => {\n  console.log('signer address : ', signerAddress);\n  const COVALENT_API_KEY = \"ckey_4aed01d0d6e248a7a4ab27acb8a\";\n  const COVALENT_MAINNET = {\n    url: \"https://api.covalenthq.com/v1/1/\"\n  };\n  const transactionsForAddress = `${COVALENT_MAINNET.url}address/${signerAddress}/transactions_v2/?key=${COVALENT_API_KEY}`; // Make a request for a user with a given ID\n\n  return axios.get(transactionsForAddress).then(function (response) {\n    // handle success\n    return response;\n  }).catch(function (error) {\n    // handle error\n    console.log(error);\n    return null;\n  });\n};","map":{"version":3,"sources":["/Users/dominiclee/Desktop/ethprojs/metaportal/src/portalHooks/useBadgeList.ts"],"names":["axios","useEffect","useState","getSuccessfulTransactionCount","parseForBadgesForTypes","parseResponseForItems","useEthers","useBadgeList","signerAddress","overrideChainId","tags","account","chainId","providerChainId","badges","setBadges","getTransactionsFor","then","response","items","successCount","console","log","errorMessage","Promise","reject","Error","catch","err","undefined","COVALENT_API_KEY","COVALENT_MAINNET","url","transactionsForAddress","get","error"],"mappings":";;AAAA,OAAOA,KAAP,MAAqC,OAArC;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,6BAAT,EAAwCC,sBAAxC,EAAgEC,qBAAhE,QAA6F,sCAA7F;AAEA,SAAkBC,SAAlB,QAAmC,eAAnC;AAYA,OAAO,SAASC,YAAT,CAAsBC,aAAtB,EAA6CC,eAA7C,EAAwEC,IAAxE,EAAyF;AAAA;;AAC9F,QAAM;AAAEC,IAAAA,OAAF;AAAWC,IAAAA,OAAO,EAAEC;AAApB,MAAwCP,SAAS,EAAvD;AACA,QAAM,CAACQ,MAAD,EAASC,SAAT,IAAsBb,QAAQ,EAApC;AACA,QAAMU,OAAO,GAAGH,eAAe,IAAII,eAAnC;AAEAZ,EAAAA,SAAS,CAAC,MAAM;AACde,IAAAA,kBAAkB,CAACR,aAAD,CAAlB,CACGS,IADH,CACQ,MAAOC,QAAP,IAAoB;AACxB,UAAIA,QAAJ,EAAc;AACV,cAAMC,KAAK,GAAGd,qBAAqB,CAACa,QAAD,CAAnC;;AAEA,YAAGC,KAAH,EAAU;AACN,gBAAMC,YAAY,GAAGjB,6BAA6B,CAACgB,KAAD,CAAlD;AACA,gBAAML,MAAM,GAAGV,sBAAsB,CAAC,CAACgB,YAAD,CAAD,CAArC;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAwBR,MAAxB;AACAC,UAAAA,SAAS,CAACD,MAAD,CAAT;AACH;AACJ,OATD,MASO;AACL,cAAMS,YAAY,GAAG,gCAArB;AACA,eAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUH,YAAV,CAAf,CAAP;AACD;AACF,KAfH,EAgBGI,KAhBH,CAgBUC,GAAD,IAAS;AACdP,MAAAA,OAAO,CAACC,GAAR,CAAYM,GAAZ;AACAb,MAAAA,SAAS,CAACc,SAAD,CAAT;AACD,KAnBH;AAoBD,GArBQ,EAqBN,CAAClB,OAAD,CArBM,CAAT;AAsBA,SAAOG,MAAP;AACD;;GA5BeP,Y;UACgCD,S;;;AA8BhD,OAAO,MAAMU,kBAAkB,GAAG,MAAOR,aAAP,IAA6D;AAC3Fa,EAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAgCd,aAAhC;AACA,QAAMsB,gBAAgB,GAAG,kCAAzB;AACA,QAAMC,gBAAgB,GAAG;AACvBC,IAAAA,GAAG,EAAE;AADkB,GAAzB;AAIA,QAAMC,sBAAsB,GAC3B,GAAEF,gBAAgB,CAACC,GAAI,WAAUxB,aAAc,yBAAwBsB,gBAAiB,EADzF,CAP2F,CAW3F;;AACA,SAAO9B,KAAK,CAACkC,GAAN,CAAUD,sBAAV,EACJhB,IADI,CACC,UAAUC,QAAV,EAAoB;AACxB;AACA,WAAOA,QAAP;AACD,GAJI,EAKJS,KALI,CAKE,UAAUQ,KAAV,EAAiB;AACtB;AACAd,IAAAA,OAAO,CAACC,GAAR,CAAYa,KAAZ;AAEA,WAAO,IAAP;AACD,GAVI,CAAP;AAWD,CAvBI","sourcesContent":["import axios, { AxiosResponse } from 'axios'\nimport { useEffect, useState } from 'react'\nimport { getSuccessfulTransactionCount, parseForBadgesForTypes, parseResponseForItems } from '../components/TokensList/BadgeHelper'\nimport { TokenInfo } from '@usedapp/core/dist/esm/src/model/TokenInfo'\nimport { ChainId, useEthers } from '@usedapp/core'\n\ninterface TokenList {\n  name: string\n  logoURI: string\n}\n\ninterface Badge {\n    badgeName: string\n    value: number\n  }\n\nexport function useBadgeList(signerAddress: string, overrideChainId?: ChainId, tags?: string[]) {\n  const { account, chainId: providerChainId } = useEthers()\n  const [badges, setBadges] = useState<Badge[]>()\n  const chainId = overrideChainId || providerChainId\n\n  useEffect(() => {\n    getTransactionsFor(signerAddress)\n      .then(async (response) => {\n        if (response) {\n            const items = parseResponseForItems(response);\n\n            if(items) {\n                const successCount = getSuccessfulTransactionCount(items);\n                const badges = parseForBadgesForTypes([successCount]);\n                console.log('badges : ',badges);\n                setBadges(badges);\n            }\n        } else {\n          const errorMessage = 'Couldnt fetch transaction data';\n          return Promise.reject(new Error(errorMessage))\n        }\n      })\n      .catch((err) => {\n        console.log(err)\n        setBadges(undefined)\n      })\n  }, [account])\n  return badges\n}\n\n\nexport const getTransactionsFor = async (signerAddress: string): Promise<AxiosResponse|null>=> {\n    console.log('signer address : ',signerAddress)\n    const COVALENT_API_KEY = \"ckey_4aed01d0d6e248a7a4ab27acb8a\"\n    const COVALENT_MAINNET = {\n      url: \"https://api.covalenthq.com/v1/1/\",\n    }\n  \n    const transactionsForAddress = \n    `${COVALENT_MAINNET.url}address/${signerAddress}/transactions_v2/?key=${COVALENT_API_KEY}`\n  \n  \n    // Make a request for a user with a given ID\n    return axios.get(transactionsForAddress)\n      .then(function (response) {\n        // handle success\n        return response\n      })\n      .catch(function (error) {\n        // handle error\n        console.log(error);\n  \n        return null;\n      });\n  }\n"]},"metadata":{},"sourceType":"module"}