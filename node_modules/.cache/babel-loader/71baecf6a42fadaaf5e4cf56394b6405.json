{"ast":null,"code":"var _jsxFileName = \"/Users/dominiclee/Desktop/ethprojs/metaportal/src/components/TokensList/TokensList.tsx\",\n    _s = $RefreshSig$();\n\nimport { formatUnits } from '@ethersproject/units';\nimport uniswapToken from '@uniswap/default-token-list';\nimport { useEthers } from '@usedapp/core';\nimport React, { useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { Colors } from '../../global/styles';\nimport { TextBold } from '../../typography/Text';\nimport { Col, Container, Row } from 'react-bootstrap';\nimport { TokenSVGIcon } from './TokenSVGIcon';\nimport { useAppSelector, useAppDispatch } from '../../hooks';\nimport { updatedSelectedItem } from './SelectedItemSlice';\nimport { ethers, utils } from 'ethers';\nimport axios from 'axios';\nimport { Contract } from '@ethersproject/contracts';\nimport { useContractFunction } from '../../workarounds/useContractFunction';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RANDOM_VISOR_COLORS = ['black', 'white', 'grey', 'green', 'blue', 'hot-pink', 'purple', 'silver', 'bronze', 'gold'];\nconst ALL_BADGES = {\n  metaPortal: {\n    accountCreation: {\n      greaterThan: [{\n        value: 0,\n        badgeName: 'Space Cadet'\n      }, {\n        value: 0,\n        badgeName: 'WAGMI Rank 1'\n      }]\n    },\n    successfulTransactions: {\n      greaterThan: [{\n        value: 25,\n        badgeName: 'Explorer Rank 1'\n      }, {\n        value: 50,\n        badgeName: 'Explorer Rank 2'\n      }, {\n        value: 75,\n        badgeName: 'Explorer Rank 3'\n      }, {\n        value: 100,\n        badgeName: 'Sky Captain Rank 1'\n      }]\n    }\n  }\n};\nconst initBadges = [];\nexport const getTransactionsFor = async signerAddress => {\n  console.log('signer address : ', signerAddress);\n  const COVALENT_API_KEY = \"ckey_4aed01d0d6e248a7a4ab27acb8a\";\n  const COVALENT_MAINNET = {\n    url: \"https://api.covalenthq.com/v1/1/\"\n  };\n  const transactionsForAddress = `${COVALENT_MAINNET.url}address/${signerAddress}/transactions_v2/?key=${COVALENT_API_KEY}`; // Make a request for a user with a given ID\n\n  return axios.get(transactionsForAddress).then(function (response) {\n    // handle success\n    return response;\n  }).catch(function (error) {\n    // handle error\n    console.log(error);\n    return null;\n  });\n};\nexport const VisorsABI = [\"function requestMint(uint256 visorId) public\"];\nexport const parseResponseForItems = response => {\n  if (!response || !response.data || !response.data.data) {\n    return null;\n  }\n\n  return response.data.data.items;\n};\nexport const getSuccessfulTransactionCount = items => {\n  let successCount = 0;\n  items.forEach(item => {\n    if (item.successful === true) {\n      successCount++;\n    }\n  });\n  return successCount;\n};\nexport const parseForBadgesForTypes = values => {\n  return [...extractBadgesForBadgeCriteria('successfulTransactions', values[0]), ...extractBadgesForBadgeCriteria('accountCreation', 1)];\n};\nexport const extractBadgesForBadgeCriteria = (badgeType, valueAchieved) => {\n  let successCount = 0;\n  let extractedBadges = [];\n  ALL_BADGES['metaPortal'][badgeType]['greaterThan'].forEach(badgeItem => {\n    if (valueAchieved > badgeItem.value) {\n      extractedBadges.push(badgeItem);\n    }\n  });\n  return extractedBadges;\n};\n\nfunction getTokenList(chainId) {\n  return uniswapToken.tokens.filter(token => token.chainId == chainId);\n}\n\nexport function TokensList() {\n  _s();\n\n  const provider = new ethers.providers.Web3Provider(window.ethereum);\n  const signer = provider.getSigner();\n  const contract = new Contract(counterContractAddress, counterContractInterface, signer);\n  const {\n    chainId,\n    account\n  } = useEthers(); // const balances = useTokensBalance(tokenList, account);\n\n  const [badges, setBadges] = useState(initBadges);\n  let mountedRef = true; // const VisorsInterface = new utils.Interface()\n\n  const VisorsContractAddress = '0x2f72199e3721c3b1eeb2913089c14c72ee9036b0'; // const contract = new Contract(VisorsContractAddress, VISORSInterface);\n\n  const {\n    send,\n    state,\n    events\n  } = useContractFunction(contract, 'requestMint', {\n    transactionName: 'requestMint'\n  }); // const { sendTransaction, state } = useSendTransaction({ transactionName: 'Send Ethereum' })\n\n  const doMint = visorId => {\n    console.log('mint.... : ', visorId);\n    send({\n      value: utils.parseEther('0.0001'),\n      arguments: ['1']\n    }); // sendTransaction({ to: '0xa284A4F80E8367391fddDBCFb820c7d98f112b28', value: utils.parseEther(visorId.toString()) })\n  };\n\n  useEffect(() => {\n    const doAsync = async () => {\n      init();\n    };\n\n    if (mountedRef) {\n      doAsync();\n    }\n\n    return () => {\n      mountedRef = false;\n    };\n  }, [mountedRef]);\n\n  const init = async () => {\n    console.log('account : ', account);\n\n    if (!account || account === undefined) {\n      return;\n    }\n\n    console.log('awaiting response....');\n    const response = await getTransactionsFor(account);\n    console.log('axios : ', response);\n\n    if (!response) {\n      return;\n    }\n\n    const items = parseResponseForItems(response);\n\n    if (!items) {\n      return;\n    }\n\n    const successCount = getSuccessfulTransactionCount(items);\n    console.log('successes : ', successCount);\n    const badges = parseForBadgesForTypes([successCount]);\n    console.log('badges : ', badges);\n    loadBadges(badges);\n  };\n\n  const selectedItemIndex = useAppSelector(state => {\n    return state.selectedItem.index;\n  });\n  const dispatch = useAppDispatch();\n\n  const handleItemSelect = (index, balance, holders, name, address) => {\n    dispatch(updatedSelectedItem({\n      index: index,\n      balance: balance,\n      holders: holders,\n      name: name,\n      address: address,\n      color: index >= 0 ? RANDOM_VISOR_COLORS[index] : null\n    }));\n  };\n\n  const loadBadges = transactionItems => {\n    setBadges(transactionItems);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: badges.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Not badges available...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 31\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: badges.map((badge, idx) => {\n          return /*#__PURE__*/_jsxDEV(Col, {\n            sm: 4,\n            md: 2,\n            lg: 2,\n            children: /*#__PURE__*/_jsxDEV(Container, {\n              children: /*#__PURE__*/_jsxDEV(Row, {\n                children: /*#__PURE__*/_jsxDEV(Col, {\n                  children: /*#__PURE__*/_jsxDEV(TokenItem, {\n                    children: [/*#__PURE__*/_jsxDEV(TokenIconContainer, {\n                      onClick: () => handleItemSelect(idx, idx, 11, `Element ${idx}`, 'address'),\n                      children: [/*#__PURE__*/_jsxDEV(TokenSVGIcon, {\n                        src: '',\n                        alt: ''\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 264,\n                        columnNumber: 23\n                      }, this), /*#__PURE__*/_jsxDEV(TokenBalance, {\n                        children: formatUnits(0, 0)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 265,\n                        columnNumber: 23\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 263,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(TokenName, {\n                      children: badge.badgeName\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 269,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(MintButton, {\n                      onClick: () => doMint(idx),\n                      children: \"Mint\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 270,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 21\n                  }, this)\n                }, `SubSection-${idx}`, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this)\n          }, `parentSection-${idx}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 252,\n    columnNumber: 5\n  }, this);\n}\n\n_s(TokensList, \"CJT4OVwg1dMYCJHlnvYFLHYzBiw=\", false, function () {\n  return [useEthers, useContractFunction, useAppSelector, useAppDispatch];\n});\n\n_c = TokensList;\nexport const Button = styled.button`\n  display: grid;\n  grid-auto-flow: column;\n  grid-column-gap: 8px;\n  align-items: center;\n  width: fit-content;\n  height: 40px;\n  font-size: 14px;\n  line-height: 24px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n  color: ${Colors.Black[900]};\n  border: 1px solid ${Colors.Black[900]};\n  background-color: transparent;\n  cursor: pointer;\n\n  &:hover,\n  &:focus {\n    background-color: ${Colors.Black[900]};\n    color: ${Colors.Yellow[100]};\n  }\n`;\nconst MintButton = styled(Button)`\n  background-color: ${Colors.Yellow[100]};\n`;\n_c2 = MintButton;\nconst List = styled.ul`\n`;\nconst ListItem = styled.li`\n`;\nconst TokenItem = styled.li`\n  display: flex;\n  flex-direction: column;\n`;\n_c3 = TokenItem;\nconst TokenIconContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  width: 120px;\n  height:120px;\n  margin: 0.2em;\n  border: 1px solid #ebebeb};\n  background: rgb(60, 60, 60);\n  background: rgba(149, 149, 149, 0.4);\n  position: relative;\n\n  &:hover,\n  &:focus, \n  &:active {\n    color: ${Colors.Yellow[100]};\n    border-width: medium;\n    border-color: ${Colors.Yellow[100]};\n  }\n`;\n_c4 = TokenIconContainer;\nconst TokenName = styled(TextBold)`\n  margin-left: 4px;\n  font-size: 12px;\n\n`;\n_c5 = TokenName;\nconst TokenTicker = styled(TextBold)`\n  grid-area: ticker;\n  color: ${Colors.Gray[600]};\n`;\nconst TokenBalance = styled(TextBold)`\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  padding:0.25em;\n  font-size: 15px;\n`;\n_c6 = TokenBalance;\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"TokensList\");\n$RefreshReg$(_c2, \"MintButton\");\n$RefreshReg$(_c3, \"TokenItem\");\n$RefreshReg$(_c4, \"TokenIconContainer\");\n$RefreshReg$(_c5, \"TokenName\");\n$RefreshReg$(_c6, \"TokenBalance\");","map":{"version":3,"sources":["/Users/dominiclee/Desktop/ethprojs/metaportal/src/components/TokensList/TokensList.tsx"],"names":["formatUnits","uniswapToken","useEthers","React","useEffect","useState","styled","Colors","TextBold","Col","Container","Row","TokenSVGIcon","useAppSelector","useAppDispatch","updatedSelectedItem","ethers","utils","axios","Contract","useContractFunction","RANDOM_VISOR_COLORS","ALL_BADGES","metaPortal","accountCreation","greaterThan","value","badgeName","successfulTransactions","initBadges","getTransactionsFor","signerAddress","console","log","COVALENT_API_KEY","COVALENT_MAINNET","url","transactionsForAddress","get","then","response","catch","error","VisorsABI","parseResponseForItems","data","items","getSuccessfulTransactionCount","successCount","forEach","item","successful","parseForBadgesForTypes","values","extractBadgesForBadgeCriteria","badgeType","valueAchieved","extractedBadges","badgeItem","push","getTokenList","chainId","tokens","filter","token","TokensList","provider","providers","Web3Provider","window","ethereum","signer","getSigner","contract","counterContractAddress","counterContractInterface","account","badges","setBadges","mountedRef","VisorsContractAddress","send","state","events","transactionName","doMint","visorId","parseEther","arguments","doAsync","init","undefined","loadBadges","selectedItemIndex","selectedItem","index","dispatch","handleItemSelect","balance","holders","name","address","color","transactionItems","length","map","badge","idx","Button","button","Black","Yellow","MintButton","List","ul","ListItem","li","TokenItem","TokenIconContainer","div","TokenName","TokenTicker","Gray","TokenBalance"],"mappings":"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","sourcesContent":["import { formatUnits } from '@ethersproject/units'\nimport uniswapToken from '@uniswap/default-token-list'\nimport { ChainId, ERC20Interface, useContractCall, useContractCalls, useEthers, useSendTransaction } from '@usedapp/core'\nimport React, { useEffect, useState } from 'react'\nimport { ERC1155Interface, VISORSInterface } from '../../interfaces/interfaces'\nimport styled from 'styled-components'\nimport { Colors } from '../../global/styles'\nimport { TextBold } from '../../typography/Text'\nimport { TokenIcon } from './TokenIcon'\nimport { Col, Container, Row } from 'react-bootstrap'\nimport { TokenSVGIcon } from './TokenSVGIcon'\nimport { useAppSelector, useAppDispatch } from '../../hooks'\nimport { increment } from '../../features/counter/counterSlice'\nimport { updatedSelectedItem } from './SelectedItemSlice'\n\nimport { ContractFactory, ethers, utils } from 'ethers'\nimport axios, { AxiosResponse } from 'axios'\nimport {Contract} from '@ethersproject/contracts'\n\nimport { useContractFunction } from '../../workarounds/useContractFunction'\n\ndeclare const window: any;\n\n\n\n\nconst RANDOM_VISOR_COLORS = [\n  'black',\n  'white',\n  'grey',\n  'green',\n  'blue',\n  'hot-pink',\n  'purple',\n  'silver',\n  'bronze',\n  'gold'\n]\n\n\nconst ALL_BADGES: any = {\n  metaPortal : {\n    accountCreation : {\n      greaterThan: [\n        {\n          value: 0,\n          badgeName: 'Space Cadet',\n        },\n        {\n          value: 0,\n          badgeName: 'WAGMI Rank 1',\n        },\n      ]\n    },\n    successfulTransactions : {\n\n      greaterThan: [\n        {\n          value: 25,\n          badgeName: 'Explorer Rank 1',\n        },\n        {\n          value: 50,\n          badgeName: 'Explorer Rank 2',\n        },\n        {\n          value: 75,\n          badgeName: 'Explorer Rank 3',\n        },\n        {\n          value: 100,\n          badgeName: 'Sky Captain Rank 1',\n        }\n      ]\n    }\n  }\n\n}\n\nconst initBadges: any[] = [];\n\nexport const getTransactionsFor = async (signerAddress: string): Promise<AxiosResponse|null>=> {\n  console.log('signer address : ',signerAddress)\n  const COVALENT_API_KEY = \"ckey_4aed01d0d6e248a7a4ab27acb8a\"\n  const COVALENT_MAINNET = {\n    url: \"https://api.covalenthq.com/v1/1/\",\n  }\n\n  const transactionsForAddress = \n  `${COVALENT_MAINNET.url}address/${signerAddress}/transactions_v2/?key=${COVALENT_API_KEY}`\n\n\n  // Make a request for a user with a given ID\n  return axios.get(transactionsForAddress)\n    .then(function (response) {\n      // handle success\n      return response\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n\n      return null;\n    });\n}\n\nexport const VisorsABI = [\n  \"function requestMint(uint256 visorId) public\",\n];\n\nexport const parseResponseForItems =(response: AxiosResponse): (any[]|null) => {\n  if(!response || !response.data || !response.data.data) {\n    return null;\n  }\n  return response.data.data.items;\n}\n\nexport const getSuccessfulTransactionCount =(items: any[]): number => {\n  let successCount = 0;\n  items.forEach((item) => {\n    if(item.successful === true) {\n      successCount++;\n    }\n  });\n  return successCount;\n}\n\n\nexport const parseForBadgesForTypes =(values: number[]): any[] => {\n  return [\n    ...extractBadgesForBadgeCriteria('successfulTransactions',values[0]),\n    ...extractBadgesForBadgeCriteria('accountCreation',1)\n  ]\n}\n\n\nexport const extractBadgesForBadgeCriteria = (badgeType: string, valueAchieved: number): any[] => {\n  let successCount = 0;\n  let extractedBadges: any[] = [];\n  \n  ALL_BADGES['metaPortal'][badgeType]['greaterThan'].forEach((badgeItem: any) => {\n    if(valueAchieved > badgeItem.value ) {\n      extractedBadges.push(badgeItem);\n    }\n  });\n  return extractedBadges;\n}\n\nfunction getTokenList(chainId?: ChainId) {\n  return uniswapToken.tokens.filter((token) => token.chainId == chainId)\n}\n\n\n\nexport function TokensList() {\n  const provider = new ethers.providers.Web3Provider(window.ethereum);\n  const signer = provider.getSigner()\n  const contract = new Contract(counterContractAddress, counterContractInterface, signer);\n\n  const { chainId, account, } = useEthers();\n  // const balances = useTokensBalance(tokenList, account);\n  const [badges, setBadges] = useState(initBadges);\n  let mountedRef = true;\n\n  // const VisorsInterface = new utils.Interface()\n  const VisorsContractAddress = '0x2f72199e3721c3b1eeb2913089c14c72ee9036b0'\n  // const contract = new Contract(VisorsContractAddress, VISORSInterface);\n\n  \n\n  const { send, state, events } = useContractFunction(contract, 'requestMint', { transactionName: 'requestMint' })\n  // const { sendTransaction, state } = useSendTransaction({ transactionName: 'Send Ethereum' })\n\n\n\n  const doMint = (visorId: number) => {\n    \n    console.log('mint.... : ',visorId)\n    send({ value: utils.parseEther('0.0001'), arguments: ['1']});\n    // sendTransaction({ to: '0xa284A4F80E8367391fddDBCFb820c7d98f112b28', value: utils.parseEther(visorId.toString()) })\n\n  }  \n  \n\n\n  useEffect(() => {\n    const doAsync = async () => {\n      init();\n    }\n    if(mountedRef) {\n      doAsync();\n    }\n    return () => {\n      mountedRef = false;\n    }; \n\n\n  }, [mountedRef]);\n\n  const init = async () => {\n    console.log('account : ',account);\n    if(!account || account === undefined){\n      return;\n    }\n    console.log('awaiting response....')\n   const response =  await getTransactionsFor(account);  \n   console.log('axios : ',response);\n\n    if(!response){\n      return;\n    }\n\n    const items = parseResponseForItems(response);\n    if(!items) {\n      return;\n    }\n    const successCount = getSuccessfulTransactionCount(items);\n\n    console.log('successes : ',successCount);\n    const badges = parseForBadgesForTypes([successCount]);\n    console.log('badges : ',badges);\n    loadBadges(badges);\n  }\n\n    const selectedItemIndex = useAppSelector((state) => {\n      return state.selectedItem.index;\n    })\n    const dispatch = useAppDispatch();\n\n    const handleItemSelect =(index: number, balance: number, holders: number,name: string, address: string) =>  {\n    \n      dispatch (updatedSelectedItem(\n        {\n          index: index,\n          balance: balance,\n          holders: holders,\n          name: name,\n          address: address,\n          color: index >= 0 ? RANDOM_VISOR_COLORS[index] : null,\n        }\n      ))\n\n    }\n\n\n    const loadBadges =(transactionItems: any[]): void => {\n      setBadges(transactionItems);\n    }\n\n\n  return (\n    <div>\n      {badges.length === 0 ? (<div>Not badges available...</div> ): (\n        <div>\n        <Row>\n        {badges.map((badge: any, idx:number) => {\n              return (\n              <Col sm={4} md={2} lg={2} key={`parentSection-${idx}`}> \n              <Container>\n              <Row>\n                  <Col key={`SubSection-${idx}`}>\n                    <TokenItem > \n                    <TokenIconContainer onClick={() => handleItemSelect(idx,idx ,11,`Element ${idx}`,'address')}>\n                      <TokenSVGIcon src={''} alt={''}></TokenSVGIcon>\n                      <TokenBalance> \n                        {formatUnits(0,0)}\n                      </TokenBalance>\n                    </TokenIconContainer>\n                    <TokenName>{badge.badgeName}</TokenName>\n                    <MintButton \n\n                      onClick={() => doMint(idx)}\n                    \n                    >Mint</MintButton>\n                  </TokenItem>\n                  </Col>\n              </Row>\n              </Container>\n              </Col>\n          )})}\n        </Row>\n      </div>\n    )}\n    </div>\n  )\n}\n\n\nexport const Button = styled.button`\n  display: grid;\n  grid-auto-flow: column;\n  grid-column-gap: 8px;\n  align-items: center;\n  width: fit-content;\n  height: 40px;\n  font-size: 14px;\n  line-height: 24px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n  color: ${Colors.Black[900]};\n  border: 1px solid ${Colors.Black[900]};\n  background-color: transparent;\n  cursor: pointer;\n\n  &:hover,\n  &:focus {\n    background-color: ${Colors.Black[900]};\n    color: ${Colors.Yellow[100]};\n  }\n`\n\nconst MintButton = styled(Button)`\n  background-color: ${Colors.Yellow[100]};\n`\n\nconst List = styled.ul`\n`\n\nconst ListItem = styled.li`\n`\n\nconst TokenItem = styled.li`\n  display: flex;\n  flex-direction: column;\n`\n\nconst TokenIconContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  width: 120px;\n  height:120px;\n  margin: 0.2em;\n  border: 1px solid #ebebeb};\n  background: rgb(60, 60, 60);\n  background: rgba(149, 149, 149, 0.4);\n  position: relative;\n\n  &:hover,\n  &:focus, \n  &:active {\n    color: ${Colors.Yellow[100]};\n    border-width: medium;\n    border-color: ${Colors.Yellow[100]};\n  }\n`\n\nconst TokenName = styled(TextBold)`\n  margin-left: 4px;\n  font-size: 12px;\n\n`\n\nconst TokenTicker = styled(TextBold)`\n  grid-area: ticker;\n  color: ${Colors.Gray[600]};\n`\n\nconst TokenBalance = styled(TextBold)`\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  padding:0.25em;\n  font-size: 15px;\n`"]},"metadata":{},"sourceType":"module"}