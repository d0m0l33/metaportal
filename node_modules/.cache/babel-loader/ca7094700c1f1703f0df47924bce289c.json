{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14;import React from'react';import styled from'styled-components';import{useEthers,getExplorerAddressLink,useEtherBalance,useContractFunction,useContractCall}from'@usedapp/core';import{formatEther}from'@ethersproject/units';import{BigNumber,utils}from'ethers';import{Colors,Shadows,Transitions}from'../../global/styles';import{ShareIcon}from'../Transactions/Icons';import{motion}from'framer-motion';import{Link}from'../base/Link';import{RequirementsList}from'./BadgeRequirementsList';import{Contract}from'@ethersproject/contracts';import{useAppDispatch}from'../../hooks';import{updatedSelectedItem}from'../TokensList/SelectedItemSlice';import{RANDOM_VISOR_COLORS}from'../../portalHooks/BadgeHelper';import{ERC1155Interface}from'../../interfaces/interfaces';import{formatUnits}from'@ethersproject/units';import{Badge}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var formatter=new Intl.NumberFormat('en-us',{minimumFractionDigits:4,maximumFractionDigits:4});var formatBalance=function formatBalance(balance){return formatter.format(parseFloat(formatEther(balance!==null&&balance!==void 0?balance:BigNumber.from('0'))));};export var VisorsABI=[\"function requestMint(uint256 visorId) public payable\"];export var BadgeOverviewModal=function BadgeOverviewModal(_ref){var setShowModal=_ref.setShowModal,badgeParams=_ref.badgeParams;var _useEthers=useEthers(),account=_useEthers.account,chainId=_useEthers.chainId,library=_useEthers.library;var balance=useEtherBalance(account);var visorInterface=new utils.Interface(VisorsABI);var signer=library===null||library===void 0?void 0:library.getSigner();var contract=null;if(badgeParams.address&&badgeParams.address!==undefined){contract=new Contract(badgeParams.address,visorInterface,signer);}else{contract=new Contract('0x0000000000000000000000000000000000000000',visorInterface,signer);}function useERC1155TokenBalance(contractAddress,account,tokenId){var _useContractCall;var _ref2=(_useContractCall=useContractCall(account&&contractAddress&&{abi:ERC1155Interface,address:contractAddress,method:'balanceOf',args:[account,tokenId]}))!==null&&_useContractCall!==void 0?_useContractCall:[],_ref3=_slicedToArray(_ref2,1),tokenBalance=_ref3[0];return tokenBalance;}var tokenBalance=useERC1155TokenBalance(badgeParams.address,account,badgeParams.tokenId);var _useContractFunction=useContractFunction(contract,'requestMint',{signer:signer,transactionName:'Mint'}),send=_useContractFunction.send;var dispatch=useAppDispatch();var handleApplyBadgeToAvatar=function handleApplyBadgeToAvatar(index,tokenId){dispatch(updatedSelectedItem({index:index,balance:0,holders:0,name:'noname',address:'noaddress',color:tokenId===null?RANDOM_VISOR_COLORS[0]:RANDOM_VISOR_COLORS[tokenId],tokenId:tokenId}));};var doMint=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(visorId){var overrides;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:overrides={value:utils.parseEther('0.1')};send([visorId],overrides);case 2:case\"end\":return _context.stop();}}},_callee);}));return function doMint(_x){return _ref4.apply(this,arguments);};}();if(account&&chainId){return/*#__PURE__*/_jsx(ModalBackground,{onClick:function onClick(){return setShowModal(false);},children:/*#__PURE__*/_jsxs(Modal,{onClick:function onClick(e){return e.stopPropagation();},layout:true,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0},children:[/*#__PURE__*/_jsxs(TitleRow,{children:[\"Badge Details\",/*#__PURE__*/_jsx(ClosingButton,{onClick:function onClick(){return setShowModal(false);},children:\"+\"})]}),/*#__PURE__*/_jsx(DomainRow,{children:/*#__PURE__*/_jsx(Badge,{pill:true,bg:\"success\",children:badgeParams.domainName})}),/*#__PURE__*/_jsxs(AccountInfo,{children:[badgeParams&&/*#__PURE__*/_jsx(AccountAddress,{children:badgeParams.name}),badgeParams&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Portal Item : \",/*#__PURE__*/_jsx(\"b\",{children:badgeParams.description})]}),badgeParams&&badgeParams.address&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Network : \",/*#__PURE__*/_jsx(\"b\",{children:badgeParams.chainName}),\" \"]}),badgeParams&&badgeParams.address&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Mint : \",/*#__PURE__*/_jsx(\"b\",{children:badgeParams.address}),\" \"]}),badgeParams&&badgeParams.address&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Token ID  : \",/*#__PURE__*/_jsx(\"b\",{children:badgeParams.tokenId}),\" \"]}),badgeParams&&badgeParams.address&&/*#__PURE__*/_jsxs(LinkWrapper,{children:[/*#__PURE__*/_jsxs(Link,{href:getExplorerAddressLink(badgeParams.address,badgeParams.chainId),target:\"_blank\",rel:\"noopener noreferrer\",children:[\"Show on etherscan\",/*#__PURE__*/_jsx(LinkIconWrapper,{children:/*#__PURE__*/_jsx(ShareIcon,{})})]}),window.isSecureContext&&/*#__PURE__*/_jsx(Link,{onClick:function onClick(){return console.log(navigator.clipboard.writeText(badgeParams.address?badgeParams.address:''));},children:\"Copy to clipboard\"})]}),tokenBalance&&/*#__PURE__*/_jsxs(BalanceWrapper,{children:[\"Balance : \",formatUnits(tokenBalance,0)]}),badgeParams&&badgeParams.address&&tokenBalance&&/*#__PURE__*/_jsx(MintButton,{onClick:function onClick(){return doMint(badgeParams.tokenId);},children:\"Mint\"}),/*#__PURE__*/_jsx(ApplyButton,{onClick:function onClick(){return handleApplyBadgeToAvatar(badgeParams.index,badgeParams.tokenId);},children:\"Apply Item\"})]}),/*#__PURE__*/_jsx(HistoryWrapper,{children:/*#__PURE__*/_jsx(RequirementsList,{requirements:badgeParams.requirements})})]})});}else{setShowModal(false);return/*#__PURE__*/_jsx(\"div\",{});}};export var Button=styled.button(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-auto-flow: column;\\n  grid-column-gap: 8px;\\n  align-items: center;\\n  padding: 5px;\\n  width: fit-content;\\n  height: 40px;\\n  font-size: 14px;\\n  line-height: 24px;\\n  font-weight: 700;\\n  text-transform: uppercase;\\n  letter-spacing: 0.1em;\\n  color: \",\";\\n  border: 1px solid \",\";\\n  background-color: transparent;\\n  cursor: pointer;\\n\\n  &:hover,\\n  &:focus {\\n    background-color: \",\";\\n    color: \",\";\\n  }\\n\"])),Colors.Black[900],Colors.Black[900],Colors.Black[900],Colors.Yellow[100]);var MintButton=styled(Button)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-bottom: 5px;\\n  background-color: \",\";\\n\"])),Colors.Yellow[100]);var ApplyButton=styled(Button)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin-bottom: 5px;\\n  background-color: \",\";\\n\"])),Colors.Gray[300]);var LinkWrapper=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-top: 20px;\\n\"])));var LinkIconWrapper=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  width: 12px;\\n  height: 12px;\\n\"])));var BalanceWrapper=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  margin-top: 12px;\\n\"])));var HistoryWrapper=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\"])));var AccountAddress=styled.p(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  font-weight: 700;\\n  margin-bottom: 10px;\\n\"])));var ClosingButton=styled.button(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  display: flex;\\n  position: absolute;\\n  top: 8px;\\n  right: 8px;\\n  justify-content: center;\\n  align-items: center;\\n  font-size: 24px;\\n  line-height: 1;\\n  width: 24px;\\n  height: 24px;\\n  transform: rotate(45deg);\\n  transition: \",\";\\n\\n  &:hover {\\n    color: \",\";\\n  }\\n\"])),Transitions.all,Colors.Yellow[500]);var TitleRow=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  position: relative;\\n  padding: 16px;\\n  width: 100%;\\n  font-size: 20px;\\n\"])));var DomainRow=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  position: relative;\\n  width: 100%;\\n  font-size: 15px;\\n  padding-left: 16px;\\n\\n\"])));var AccountInfo=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  display: block;\\n  margin: 16px;\\n  padding: 16px;\\n  border-radius: 10px;\\n  box-shadow: \",\";\\n  background-color: \",\";\\n\"])),Shadows.main,Colors.White);var Modal=styled(motion.div)(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  width: 600px;\\n\\n  left: calc(50% - 300px);\\n  top: 100px;\\n  background-color: white;\\n  box-shadow: \",\";\\n  border-radius: 10px;\\n  z-index: 3;\\n\"])),Shadows.main);var ModalBackground=styled(motion.div)(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  top: 0;\\n  left: 0;\\n  position: fixed;\\n  width: 100%;\\n  height: 100%;\\n  margin: 0px;\\n  z-index: 2;\\n  background-color: rgba(235, 232, 223, 0.5);\\n\"])));","map":{"version":3,"sources":["/Users/dominiclee/Desktop/ethprojs/metaportal/src/components/badge/BadgeOverviewModal.tsx"],"names":["React","styled","useEthers","getExplorerAddressLink","useEtherBalance","useContractFunction","useContractCall","formatEther","BigNumber","utils","Colors","Shadows","Transitions","ShareIcon","motion","Link","RequirementsList","Contract","useAppDispatch","updatedSelectedItem","RANDOM_VISOR_COLORS","ERC1155Interface","formatUnits","Badge","formatter","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","formatBalance","balance","format","parseFloat","from","VisorsABI","BadgeOverviewModal","setShowModal","badgeParams","account","chainId","library","visorInterface","Interface","signer","getSigner","contract","address","undefined","useERC1155TokenBalance","contractAddress","tokenId","abi","method","args","tokenBalance","transactionName","send","dispatch","handleApplyBadgeToAvatar","index","holders","name","color","doMint","visorId","overrides","value","parseEther","e","stopPropagation","opacity","y","domainName","description","chainName","window","isSecureContext","console","log","navigator","clipboard","writeText","requirements","Button","button","Black","Yellow","MintButton","ApplyButton","Gray","LinkWrapper","div","LinkIconWrapper","BalanceWrapper","HistoryWrapper","AccountAddress","p","ClosingButton","all","TitleRow","DomainRow","AccountInfo","main","White","Modal","ModalBackground"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\nimport { useEthers, getExplorerAddressLink, useEtherBalance, useContractFunction, useContractCall } from '@usedapp/core'\nimport { TransactionsList } from '../Transactions/History'\nimport { formatEther } from '@ethersproject/units'\nimport { BigNumber, utils } from 'ethers'\nimport { Colors, Shadows, Transitions } from '../../global/styles'\nimport { ShareIcon } from '../Transactions/Icons'\nimport { motion } from 'framer-motion'\nimport { Link } from '../base/Link'\nimport { RequirementsList } from './BadgeRequirementsList'\nimport { Contract } from '@ethersproject/contracts'\nimport { useAppDispatch, useAppSelector } from '../../hooks'\nimport { updatedSelectedItem } from '../TokensList/SelectedItemSlice'\nimport { RANDOM_VISOR_COLORS } from '../../portalHooks/BadgeHelper'\nimport { ERC1155Interface } from '../../interfaces/interfaces'\nimport { formatUnits } from '@ethersproject/units'\nimport { Badge } from 'react-bootstrap'\n\n\nexport interface BadgeParams {\n  domainName: string,\n  name: string, \n  index: number,\n  description: string,\n  requirements: string[],\n  address: string | null,\n  chainName: string | null,\n  chainId: number,\n  tokenId: number,\n}\n\n\nconst formatter = new Intl.NumberFormat('en-us', {\n  minimumFractionDigits: 4,\n  maximumFractionDigits: 4,\n})\n\nconst formatBalance = (balance: BigNumber | undefined) =>\n  formatter.format(parseFloat(formatEther(balance ?? BigNumber.from('0'))))\n\nexport type BadgeOverviewModalProps = {\n  setShowModal: React.Dispatch<React.SetStateAction<boolean>>,\n  badgeParams: BadgeParams\n}\n\nexport const VisorsABI = [\n  \"function requestMint(uint256 visorId) public payable\",\n];\n\n\n\nexport const BadgeOverviewModal = ({ setShowModal, badgeParams }: BadgeOverviewModalProps) => {\n  const { account, chainId, library } = useEthers()\n  const balance = useEtherBalance(account)\n  const visorInterface = new utils.Interface(VisorsABI)\n  const signer = library?.getSigner();\n  let contract: Contract|null = null;\n  if (badgeParams.address && badgeParams.address !== undefined) {\n    contract =  new Contract(badgeParams.address, visorInterface, signer);\n  }  \n  else {\n    contract =  new Contract('0x0000000000000000000000000000000000000000', visorInterface, signer);\n  }\n\n  function useERC1155TokenBalance(contractAddress: (string|undefined|null),  account: (string|undefined|null), tokenId:  (number|undefined|null)): any[] {\n    const [tokenBalance] =\n      useContractCall(\n        account &&\n        contractAddress && {\n            abi: ERC1155Interface,\n            address: contractAddress,\n            method: 'balanceOf',\n            args: [account, tokenId],\n          }\n      ) ?? []\n    return tokenBalance\n  }\n\n  const tokenBalance = useERC1155TokenBalance(\n    badgeParams.address,\n    account,\n    badgeParams.tokenId,\n    );\n  const { send } = useContractFunction(contract, 'requestMint', { signer: signer,  transactionName: 'Mint' });\n\n  const dispatch = useAppDispatch();\n\n  const handleApplyBadgeToAvatar =(index: number| null, tokenId: number| null) =>  {\n    dispatch (updatedSelectedItem(\n      {\n        index: index,\n        balance: 0,\n        holders: 0,\n        name: 'noname',\n        address: 'noaddress',\n        color: tokenId === null ? RANDOM_VISOR_COLORS[0]: RANDOM_VISOR_COLORS[tokenId],\n        tokenId: tokenId\n      }\n    ));\n    \n  }\n\n  const doMint = async (visorId: number) => {\n    let overrides = {\n      value: utils.parseEther('0.1')\n    };\n    send([visorId],overrides);\n  }  \n  if (account && chainId) {\n    return (\n      <ModalBackground onClick={() => setShowModal(false)}>\n        <Modal\n          onClick={(e) => e.stopPropagation()}\n          layout\n          initial={{ opacity: 0, y: -50 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0 }}\n        >\n          <TitleRow>\n            Badge Details\n            <ClosingButton onClick={() => setShowModal(false)}>+</ClosingButton>\n          </TitleRow>\n          <DomainRow>\n            <Badge pill bg=\"success\">{badgeParams.domainName}</Badge>\n          </DomainRow>\n       \n          <AccountInfo>\n          {badgeParams && <AccountAddress>{badgeParams.name}</AccountAddress>}\n          {badgeParams && <p>Portal Item : <b>{badgeParams.description}</b></p>}\n          {(badgeParams && badgeParams.address) && <p>Network : <b>{badgeParams.chainName}</b> </p>}\n          {(badgeParams && badgeParams.address) && <p>Mint : <b>{badgeParams.address}</b> </p>}\n          {(badgeParams && badgeParams.address) && <p>Token ID  : <b>{badgeParams.tokenId}</b> </p>}\n\n          {       \n            (badgeParams && badgeParams.address) &&\n            <LinkWrapper>\n              <Link href={getExplorerAddressLink(badgeParams.address, badgeParams.chainId)} target=\"_blank\" rel=\"noopener noreferrer\">\n                Show on etherscan\n                <LinkIconWrapper>\n                  <ShareIcon />\n                </LinkIconWrapper>\n              </Link>\n              {window.isSecureContext && (\n                <Link onClick={() => console.log(navigator.clipboard.writeText(badgeParams.address ? badgeParams.address : ''))}>Copy to clipboard</Link>\n              )}\n            </LinkWrapper>\n            }\n          {tokenBalance && <BalanceWrapper>Balance : {formatUnits(tokenBalance,0)}</BalanceWrapper> }\n          {(badgeParams && badgeParams.address && tokenBalance) && <MintButton onClick={() => doMint(badgeParams.tokenId)} >Mint</MintButton>}   \n        \n          <ApplyButton onClick={() => handleApplyBadgeToAvatar(\n            badgeParams.index, \n            badgeParams.tokenId\n             )}>Apply Item</ApplyButton>\n          </AccountInfo>\n          <HistoryWrapper>\n  \n            <RequirementsList requirements={badgeParams.requirements}/>\n          </HistoryWrapper>\n        </Modal>\n      </ModalBackground>\n    )\n  } else {\n    setShowModal(false)\n    return <div />\n  }\n}\n\nexport const Button = styled.button`\n  display: grid;\n  grid-auto-flow: column;\n  grid-column-gap: 8px;\n  align-items: center;\n  padding: 5px;\n  width: fit-content;\n  height: 40px;\n  font-size: 14px;\n  line-height: 24px;\n  font-weight: 700;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n  color: ${Colors.Black[900]};\n  border: 1px solid ${Colors.Black[900]};\n  background-color: transparent;\n  cursor: pointer;\n\n  &:hover,\n  &:focus {\n    background-color: ${Colors.Black[900]};\n    color: ${Colors.Yellow[100]};\n  }\n`\n\nconst MintButton = styled(Button)`\n  margin-bottom: 5px;\n  background-color: ${Colors.Yellow[100]};\n`\n\nconst ApplyButton = styled(Button)`\n  margin-bottom: 5px;\n  background-color: ${Colors.Gray[300]};\n`\n\nconst LinkWrapper = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 20px;\n`\n\nconst LinkIconWrapper = styled.div`\n  width: 12px;\n  height: 12px;\n`\n\nconst BalanceWrapper = styled.div`\n  margin-top: 12px;\n`\n\nconst HistoryWrapper = styled.div``\n\nconst AccountAddress = styled.p`\n  font-weight: 700;\n  margin-bottom: 10px;\n`\n\nconst ClosingButton = styled.button`\n  display: flex;\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  justify-content: center;\n  align-items: center;\n  font-size: 24px;\n  line-height: 1;\n  width: 24px;\n  height: 24px;\n  transform: rotate(45deg);\n  transition: ${Transitions.all};\n\n  &:hover {\n    color: ${Colors.Yellow[500]};\n  }\n`\n\nconst TitleRow = styled.div`\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding: 16px;\n  width: 100%;\n  font-size: 20px;\n`\nconst DomainRow = styled.div`\n  display: flex;\n  align-items: center;\n  position: relative;\n  width: 100%;\n  font-size: 15px;\n  padding-left: 16px;\n\n`\n\nconst AccountInfo = styled.div`\n  display: block;\n  margin: 16px;\n  padding: 16px;\n  border-radius: 10px;\n  box-shadow: ${Shadows.main};\n  background-color: ${Colors.White};\n`\n\nconst Modal = styled(motion.div)`\n  position: fixed;\n  width: 600px;\n\n  left: calc(50% - 300px);\n  top: 100px;\n  background-color: white;\n  box-shadow: ${Shadows.main};\n  border-radius: 10px;\n  z-index: 3;\n`\n\nconst ModalBackground = styled(motion.div)`\n  top: 0;\n  left: 0;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  z-index: 2;\n  background-color: rgba(235, 232, 223, 0.5);\n`\n"]},"metadata":{},"sourceType":"module"}