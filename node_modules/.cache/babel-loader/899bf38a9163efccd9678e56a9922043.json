{"ast":null,"code":"import _slicedToArray from \"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"frames\", \"opacity\", \"width\", \"height\", \"blur\", \"far\", \"resolution\"];\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree, useFrame } from '@react-three/fiber';\nimport { HorizontalBlurShader, VerticalBlurShader } from 'three-stdlib';\nvar ContactShadows = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var _ref$frames = _ref.frames,\n      frames = _ref$frames === void 0 ? Infinity : _ref$frames,\n      _ref$opacity = _ref.opacity,\n      opacity = _ref$opacity === void 0 ? 1 : _ref$opacity,\n      _ref$width = _ref.width,\n      width = _ref$width === void 0 ? 1 : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === void 0 ? 1 : _ref$height,\n      _ref$blur = _ref.blur,\n      blur = _ref$blur === void 0 ? 1 : _ref$blur,\n      _ref$far = _ref.far,\n      far = _ref$far === void 0 ? 10 : _ref$far,\n      _ref$resolution = _ref.resolution,\n      resolution = _ref$resolution === void 0 ? 256 : _ref$resolution,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  var scene = useThree(function (_ref2) {\n    var scene = _ref2.scene;\n    return scene;\n  });\n  var gl = useThree(function (_ref3) {\n    var gl = _ref3.gl;\n    return gl;\n  });\n  var shadowCamera = React.useRef();\n\n  var _React$useMemo = React.useMemo(function () {\n    var renderTarget = new THREE.WebGLRenderTarget(resolution, resolution);\n    var renderTargetBlur = new THREE.WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    var planeGeometry = new THREE.PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    var blurPlane = new THREE.Mesh(planeGeometry);\n    var depthMaterial = new THREE.MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = function (shader) {\n      return shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n    };\n\n    var horizontalBlurMaterial = new THREE.ShaderMaterial(HorizontalBlurShader);\n    var verticalBlurMaterial = new THREE.ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height]),\n      _React$useMemo2 = _slicedToArray(_React$useMemo, 7),\n      renderTarget = _React$useMemo2[0],\n      planeGeometry = _React$useMemo2[1],\n      depthMaterial = _React$useMemo2[2],\n      blurPlane = _React$useMemo2[3],\n      horizontalBlurMaterial = _React$useMemo2[4],\n      verticalBlurMaterial = _React$useMemo2[5],\n      renderTargetBlur = _React$useMemo2[6];\n\n  var count = 0;\n  useFrame(function () {\n    if (shadowCamera.current && (frames === Infinity || count < frames)) {\n      var initialBackground = scene.background;\n      scene.background = null;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = null;\n      blurPlane.material = horizontalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTarget.texture;\n      horizontalBlurMaterial.uniforms.h.value = blur / 256;\n      gl.setRenderTarget(renderTargetBlur);\n      gl.render(blurPlane, shadowCamera.current);\n      blurPlane.material = verticalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTargetBlur.texture;\n      verticalBlurMaterial.uniforms.v.value = blur / 256;\n      gl.setRenderTarget(renderTarget);\n      gl.render(blurPlane, shadowCamera.current);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n      count++;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\nexport { ContactShadows };","map":{"version":3,"sources":["/Users/dominiclee/Desktop/ethprojs/metaportal/node_modules/@react-three/drei/core/ContactShadows.js"],"names":["_extends","React","THREE","useThree","useFrame","HorizontalBlurShader","VerticalBlurShader","ContactShadows","forwardRef","ref","frames","Infinity","opacity","width","height","blur","far","resolution","props","scene","gl","shadowCamera","useRef","useMemo","renderTarget","WebGLRenderTarget","renderTargetBlur","texture","generateMipmaps","planeGeometry","PlaneBufferGeometry","rotateX","Math","PI","blurPlane","Mesh","depthMaterial","MeshDepthMaterial","depthTest","depthWrite","onBeforeCompile","shader","fragmentShader","replace","horizontalBlurMaterial","ShaderMaterial","verticalBlurMaterial","count","current","initialBackground","background","overrideMaterial","setRenderTarget","render","material","uniforms","tDiffuse","value","h","v","createElement","geometry","scale","rotation","map","transparent","args"],"mappings":"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","sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree, useFrame } from '@react-three/fiber';\nimport { HorizontalBlurShader, VerticalBlurShader } from 'three-stdlib';\n\nconst ContactShadows = /*#__PURE__*/React.forwardRef(({\n  frames = Infinity,\n  opacity = 1,\n  width = 1,\n  height = 1,\n  blur = 1,\n  far = 10,\n  resolution = 256,\n  ...props\n}, ref) => {\n  const scene = useThree(({\n    scene\n  }) => scene);\n  const gl = useThree(({\n    gl\n  }) => gl);\n  const shadowCamera = React.useRef();\n  const [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur] = React.useMemo(() => {\n    const renderTarget = new THREE.WebGLRenderTarget(resolution, resolution);\n    const renderTargetBlur = new THREE.WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    const planeGeometry = new THREE.PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    const blurPlane = new THREE.Mesh(planeGeometry);\n    const depthMaterial = new THREE.MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = shader => shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n\n    const horizontalBlurMaterial = new THREE.ShaderMaterial(HorizontalBlurShader);\n    const verticalBlurMaterial = new THREE.ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height]);\n  let count = 0;\n  useFrame(() => {\n    if (shadowCamera.current && (frames === Infinity || count < frames)) {\n      const initialBackground = scene.background;\n      scene.background = null;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = null;\n      blurPlane.material = horizontalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTarget.texture;\n      horizontalBlurMaterial.uniforms.h.value = blur / 256;\n      gl.setRenderTarget(renderTargetBlur);\n      gl.render(blurPlane, shadowCamera.current);\n      blurPlane.material = verticalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTargetBlur.texture;\n      verticalBlurMaterial.uniforms.v.value = blur / 256;\n      gl.setRenderTarget(renderTarget);\n      gl.render(blurPlane, shadowCamera.current);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n      count++;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\n\nexport { ContactShadows };\n"]},"metadata":{},"sourceType":"module"}