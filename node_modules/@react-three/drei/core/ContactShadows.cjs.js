"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("react"),t=require("three"),a=require("@react-three/fiber"),n=require("three-stdlib");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var a=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,a.get?a:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var i=u(e),l=o(r),s=o(t);const c=l.forwardRef((({frames:e=1/0,opacity:r=1,width:t=1,height:u=1,blur:o=1,far:c=10,resolution:d=256,...f},h)=>{const m=a.useThree((({scene:e})=>e)),p=a.useThree((({gl:e})=>e)),g=l.useRef(),[b,M,v,w,T,y,x]=l.useMemo((()=>{const e=new s.WebGLRenderTarget(d,d),r=new s.WebGLRenderTarget(d,d);r.texture.generateMipmaps=e.texture.generateMipmaps=!1;const a=new s.PlaneBufferGeometry(t,u).rotateX(Math.PI/2),o=new s.Mesh(a),i=new s.MeshDepthMaterial;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=e=>e.fragmentShader=e.fragmentShader.replace("1.0 - fragCoordZ ), opacity );","0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );");const l=new s.ShaderMaterial(n.HorizontalBlurShader),c=new s.ShaderMaterial(n.VerticalBlurShader);return c.depthTest=l.depthTest=!1,[e,a,i,o,l,c,r]}),[d,t,u]);let R=0;return a.useFrame((()=>{if(g.current&&(e===1/0||R<e)){const e=m.background;m.background=null,m.overrideMaterial=v,p.setRenderTarget(b),p.render(m,g.current),m.overrideMaterial=null,w.material=T,w.material.uniforms.tDiffuse.value=b.texture,T.uniforms.h.value=o/256,p.setRenderTarget(x),p.render(w,g.current),w.material=y,w.material.uniforms.tDiffuse.value=x.texture,y.uniforms.v.value=o/256,p.setRenderTarget(b),p.render(w,g.current),p.setRenderTarget(null),m.background=e,R++}})),l.createElement("group",i.default({},f,{ref:h}),l.createElement("mesh",{geometry:M,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},l.createElement("meshBasicMaterial",{map:b.texture,transparent:!0,opacity:r})),l.createElement("orthographicCamera",{ref:g,args:[-t/2,t/2,u/2,-u/2,0,c]}))}));exports.ContactShadows=c;
