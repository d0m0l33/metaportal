"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three");class a extends e.Loader{load(a,t,r,i){const n=new e.FileLoader(this.manager);n.setPath(this.path),n.setResponseType("text"),n.load(a,(e=>{try{t(this.parse(e))}catch(e){i?i(e):console.error(e),this.manager.itemError(a)}}),r,i)}parse(a){a=a.replace(/^#.*?(\n|\r)/gm,"").replace(/^\s*?(\n|\r)/gm,"").trim();let t=null,r=null;const i=new e.Vector3(0,0,0),n=new e.Vector3(1,1,1),s=a.split(/[\n\r]+/g);let p=null,o=0;for(let e=0,a=s.length;e<a;e++){const a=s[e].trim(),l=a.split(/\s/g);switch(l[0]){case"TITLE":t=a.substring(7,a.length-1);break;case"LUT_3D_SIZE":const e=l[1];r=parseFloat(e),p=new Uint8Array(r*r*r*3);break;case"DOMAIN_MIN":i.x=parseFloat(l[1]),i.y=parseFloat(l[2]),i.z=parseFloat(l[3]);break;case"DOMAIN_MAX":n.x=parseFloat(l[1]),n.y=parseFloat(l[2]),n.z=parseFloat(l[3]);break;default:const s=parseFloat(l[0]),g=parseFloat(l[1]),m=parseFloat(l[2]);if(s>1||s<0||g>1||g<0||m>1||m<0)throw new Error("LUTCubeLoader : Non normalized values not supported.");p[o+0]=255*s,p[o+1]=255*g,p[o+2]=255*m,o+=3}}const l=new e.DataTexture;l.image.data=p,l.image.width=r,l.image.height=r*r,l.format=e.RGBFormat,l.type=e.UnsignedByteType,l.magFilter=e.LinearFilter,l.minFilter=e.LinearFilter,l.wrapS=e.ClampToEdgeWrapping,l.wrapT=e.ClampToEdgeWrapping,l.generateMipmaps=!1;const g=new e.DataTexture3D;return g.image.data=p,g.image.width=r,g.image.height=r,g.image.depth=r,g.format=e.RGBFormat,g.type=e.UnsignedByteType,g.magFilter=e.LinearFilter,g.minFilter=e.LinearFilter,g.wrapS=e.ClampToEdgeWrapping,g.wrapT=e.ClampToEdgeWrapping,g.wrapR=e.ClampToEdgeWrapping,g.generateMipmaps=!1,{title:t,size:r,domainMin:i,domainMax:n,texture:l,texture3D:g}}}exports.LUTCubeLoader=a;
